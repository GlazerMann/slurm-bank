<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>slurm-bank</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" href="style.css" type="text/css" />

<link rel="stylesheet" href="local.css" type="text/css" />










</head>
<body>

<div class="page">

<div class="pageheader">
<div class="header">
<span>
<span class="parentlinks">

</span>
<span class="title">
slurm-bank

</span>
</span>



</div>









</div>



<div class="sidebar">
<p>[[!img <span class="error">Error: Image::Magick is not installed</span>]]</p>

<ul>
<li><a href="./download.html">download</a></li>
<li><a href="./install.html">install</a></li>
<li><a href="./bugs.html">bugs</a></li>
<li><a href="./walkthrough.html">walkthrough</a></li>
<li><a href="./design.html">design</a></li>
<li><a href="./contact.html">contact</a></li>
<li><a href="./copyright.html">copyright</a></li>
</ul>


</div>



<div id="pagebody">

<div id="content" role="main">
<h2>About</h2>

<p>SLURM Bank, a collection of wrapper scripts to give slurm GOLD like
capabilities for managing resources.</p>

<p>With the scripts we are able to provide a simple <em>banking</em> system
where we can deposit hours to an account. Users are associated with
these accounts which they use to run jobs. If users do not have an
account or if they do not have hours in their account then they cannot
run jobs.</p>

<table>
<tr>
<td width="50%" valign="top"><h3>What the user <em>Charles</em> will want to know</h3>

<p><code>sbank balance statement -u</code> to see Charles' own balance. Apart from
this one command Charles does not need to know much more about the
slurm bank commands.</p>

<p>If Charles was a PI or Team leader in a project, he may want to see
a more detailed balance sheet. He can do this by <code>sbank balance
statement</code>. This will show the usage for all members of all of his
projects.</p>



</td>
<td width="50%" valign="top"><h3>What the admin <em>David</em> needs to know</h3>

<p>The admin David will need to far more than the user. David will
need to decide on some policies and allocations. Create projects
with <a href="./sbank-project.html">sbank-project</a> and add people to projects with <a href="./sbank-project.html">sbank-project</a>.</p>

<p>Once the projects have been created David will need to deposit hours
to projects using <a href="./sbank-deposit.html">sbank-deposit</a>.</p>

<p>David could also check the balances of all accounts and users with
<code>sbank balance statement -A</code></p>



</td>
</tr>
</table>


<h2>Motivation</h2>

<p>To replace our (at <a href="http://www.tchpc.tcd.ie/">TCHPC</a>) current Resource Management and Allocation Systems
which comprises three pieces of software (<a href="https://computing.llnl.gov/linux/slurm/">slurm</a>, <a href="http://www.clusterresources.com/pages/products/gold/">GOLD</a> and
<a href="http://www.clusterresources.com/products/maui/">maui</a>) with just a single piece of software: Slurm.</p>

<p>Having all of the banking functionality of SLURM wrapped up has
benefits for both the systems administrators:</p>

<ul>
<li>Having just slurm without maui means there are less things to go
wrong</li>
<li>Overall performance for scheduling and launching jobs is much better
with just slurm</li>
<li>GOLD is overly complicated and we don't need many of the features
from GOLD</li>
</ul>


<p>And also benefits for end users of clusters:</p>

<ul>
<li>Less commands/systems to learn</li>
<li>Faster job submission and turn-around</li>
<li>Greater overall system stability</li>
</ul>


<h2>Experience with the migratation</h2>

<p>Moving from GOLD, Maui and SLURM to just running SLURM required us to
gather some information.</p>

<ul>
<li>List of Principle Investigators who own accounts/projects</li>
<li>List of projects</li>
<li>List of users</li>
</ul>


<p>We also required a set of associations</p>

<ul>
<li>PI -&gt; projects -&gt; users</li>
</ul>


<p>The mapping we ended up having in the end in the slurmdbd was kept simple</p>

<ul>
<li>projects -&gt; users</li>
</ul>


<p>Which gave us a hierachy like this</p>

<ul>
<li>root

<ul>
<li>project1

<ul>
<li>user1</li>
<li>user2</li>
</ul>
</li>
<li>project2

<ul>
<li>user1</li>
<li>user3</li>
<li>user4</li>
</ul>
</li>
<li>project3

<ul>
<li>user3</li>
</ul>
</li>
</ul>
</li>
</ul>


<p>and so on...</p>

<h2>Design</h2>

<p>The <a href="./design.html">design</a> document contains ideas (todo and done). So far we have
discovered that slurm already has much of the needed functionality
required for "banking". Much of the <a href="./sbank.html">sbank</a> commands are just
wrapper scripts to already existing slurm commands. One of the
problems with banking is being consistent, the sbank wrapper scripts
try to provide a workflow to provide a GOLD like banking system with
slurm.</p>

<p>SLURM bank is extremely simple and only very basic banking
functionality is provided. That is when a user or a group of users run
out of time in an account the jobs that are running will be
immediately terminated. In SLURM bank we do not have reservation of
time to ensure jobs complete, it is up to the user to figure that out,
by doing so users will hopefully be more aware of the time that they
have used. We also do not have the notion of crediting or overdrawing
so if jobs fail due to system failures etc... users will not be
automatically refunded hours. This issue will be left up to the users
and admins to resolve.</p>

<h3>Needed components</h3>

<p>This is now available with slurm-bank</p>

<ul>
<li>A consistent way of adding/removing projects and users to said
projects.</li>
<li>A way of adding/removing hours from a project (account).</li>
<li>A way of telling users how much time they have left and how much
time they have used.</li>
<li>A way of letting users know if they can complete a job or not
(easily).</li>
</ul>


<p>You can do everything that these wrapper scripts are doing with plain
slurm commands! We stress that these scripts are just fixing the
workflows in managing accounts and users as well as providing some
helper tools to let users manage their own resources.</p>

<p>The SLURM software itself is free and open-source, under a GPLv2
Licence, so anyone could freely and easily replicate the work
undertaken here themselves.</p>

<p>Also, note that the software itself is fully-readable scripts (no
compiled code) and its behaviour is fully documented, it is trivial
for any user on our systems to view the documentation and scripts, and
re-implement it themselves.</p>

<h2>Documentation</h2>

<p>See the <a href="./walkthrough.html">walkthrough</a> for an example of how to implement and use
slurm-bank.</p>

<h3>Shell scripts</h3>

<ul>
<li><a href="./sbank.html">sbank</a></li>
<li><a href="./sbank-balance.html">sbank-balance</a></li>
<li><a href="./sbank-cluster.html">sbank-cluster</a></li>
<li><a href="./sbank-deposit.html">sbank-deposit</a></li>
<li><a href="./sbank-project.html">sbank-project</a></li>
<li><a href="./sbank-time.html">sbank-time</a></li>
</ul>


<h3>Experimental scripts</h3>

<ul>
<li><a href="./sbank-submit.html">sbank-submit</a></li>
<li><a href="./sbank-user.html">sbank-user</a></li>
<li><a href="./sbank-refund.html">sbank-refund</a></li>
</ul>


<h3>Proposed scripts</h3>

<ul>
<li><span class="createlink">sbank-report</span> -- this might be better provided with the
<a href="./sbank-balance.html">sbank-balance</a> script.</li>
</ul>


<h2>Repo history</h2>

<pre><code>git shortlog --since "Mon May 16 17:12:35 2011"
</code></pre>

</div>





<div id="comments" role="complementary">




<div class="addcomment">Comments on this page are closed.</div>

</div>



</div>

<div id="footer" class="pagefooter" role="contentinfo">

<div id="pageinfo">











<div class="pagedate">
Last edited <span class="date">Fri 26 Oct 05:12:33 2018</span>
<!-- Created <span class="date">Tue 21 Feb 23:35:21 2012</span> -->
</div>

</div>


<!-- from slurm-bank -->
</div>

</div>

</body>
</html>
