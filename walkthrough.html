<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>walkthrough</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" href="style.css" type="text/css" />

<link rel="stylesheet" href="local.css" type="text/css" />










</head>
<body>

<div class="page">

<div class="pageheader">
<div class="header">
<span>
<span class="parentlinks">

<a href="./index.html">slurm-bank</a>/ 

</span>
<span class="title">
walkthrough

</span>
</span>



</div>









</div>





<div id="pagebody">

<div id="content" role="main">
<p>A walkthrough of the basic features of sbank.</p>

<div class="toc">
	<ol>
		<li class="L2"><a href="#index1h2">Installing slurm bank</a>
		</li>
		<li class="L2"><a href="#index2h2">Requirements</a>
		</li>
		<li class="L2"><a href="#index3h2">Installing on a RHEL5x or clone</a>
		</li>
		<li class="L2"><a href="#index4h2">Installing on a generic Linux system</a>
		</li>
		<li class="L2"><a href="#index5h2">Documentation / inline help / man pages</a>
		</li>
		<li class="L2"><a href="#index6h2">Tests</a>
		</li>
	</ol>
</div>




<h2><a name="index1h2"></a><a href="./install.html">Installing slurm bank</a></h2>
<p>To install slurm-bank</p>

<h2><a name="index2h2"></a>Requirements</h2>

<p>A working SLURM installation with perl and bash, we assume that
slurmdbd is setup and functioning correctly.</p>

<div class="feedlink">


</div>


<p>The first thing to do is to setup <a href="https://computing.llnl.gov/linux/slurm/">slurm</a> and <a href="https://computing.llnl.gov/linux/slurm/accounting.html">slurmdbd</a>. This
documentation assumes the user knows basic slurm administration.</p>




<p>Slurmdbd must be configured and working, account enforcing is enabled
in <em>slurm.conf</em></p>




<pre><code>AccountingStorageEnforce=limits
</code></pre>




<p>Note that the <em>PriorityDecayHalfLife</em> and <em>PriorityUsageResetPeriod</em> can
be used to allow usage half-life decay and reset. This is because
the usage information is pulled directly from the Slurmdbd via
<em>sreport</em>; whereas the two parameters above only affect the way
usage is stored in local *_usage files.</p>




<p>Note also that when the scheduler looks to see if an association has
sufficient balance to start a new job, it compares the "GrpCPUMins"
field against the local *_usage files to check if enough time is
available (not the Slurmdbd), this can result in negative balances
being reported by "sbank balance statement".</p>




<p>What is also required is a pretty good estimate of the total available
cpu hours that you have on your cluster that you can allocate to
accounts.</p>




<p><a href="./sbank-cluster.html">sbank-cluster</a> can provide a rough estimate of what's available.</p>




<pre><code>$ sbank cluster cpuhrs
</code></pre>




<p>Users will need to learn how to use accounts (nothing new here).</p>




<p>sbatch, sinfo, sacctmgr and sreport are required and must be working.</p>




<p>One implementation detail is that 'sreport' requires a start date
parameter (otherwise it defaults to the previous day). The script defaults
to using a start date of 3 years in the past. This can be changed with
the '-s yyyy-mm-dd' parameter.</p>




<p>If you do not already have a cluster registered and configured in slurm,</p>




<pre><code>$ sbank cluster create mycluster
</code></pre>


<h2><a name="index3h2"></a>Installing on a RHEL5x or clone</h2>

<p>If you have a release tarball, and have ikiwiki installed</p>

<pre><code>$ rpmbuild -ta slurm-bank-1.0.tar.gz
</code></pre>

<p>or else if you do not have ikiwiki you can do</p>

<pre><code>$ rpmbuild -ta --without docs slurm-bank-1.0.tar.gz
</code></pre>

<p>Once the RPM's are created you can simply install the RPM's</p>

<h2><a name="index4h2"></a>Installing on a generic Linux system</h2>

<pre><code>$ tar zxvf slurm-bank-1.0.tar.gz
$ cd slurm-bank-1.0
$ make install
</code></pre>

<p>To install the html documentation,</p>

<pre><code>$ make install-docs
</code></pre>

<p>The html documentation requires ikiwiki to be installed.</p>

<h2><a name="index5h2"></a>Documentation / inline help / man pages</h2>

<p>Once the package is installed users and admins can do following to get
inline help</p>

<pre><code>$ man sbank
</code></pre>

<p>or</p>

<pre><code>$ sbank help
</code></pre>

<h2><a name="index6h2"></a>Tests</h2>

<p>There are some simple <a href="./tests.html">tests</a> which can be run,</p>

<pre><code>make test
</code></pre>

<p>the tests need more work and documentation such that if the scripts are
re-implemented in C/Perl or whatever language we can verify that the
behaviour is correct.</p>






</div>





<div id="comments" role="complementary">




<div class="addcomment">Comments on this page are closed.</div>

</div>



</div>

<div id="footer" class="pagefooter" role="contentinfo">

<div id="pageinfo">






<div id="backlinks">
Links:

<a href="./index.html">index</a>


</div>






<div class="pagedate">
Last edited <span class="date">Fri 26 Oct 05:11:42 2018</span>
<!-- Created <span class="date">Tue 21 Feb 23:22:27 2012</span> -->
</div>

</div>


<!-- from slurm-bank -->
</div>

</div>

</body>
</html>
